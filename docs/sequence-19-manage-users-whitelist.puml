@startuml
!theme plain
skinparam sequenceArrowThickness 2
skinparam roundcorner 20
skinparam maxmessagesize 60

title Manage Users & Whitelist Sequence
participant Admin
participant UserManagementPage
participant UserAPI
participant WhitelistAPI
participant prisma
participant User
participant WhitelistedEmail

Admin -> UserManagementPage: Access user management
UserManagementPage -> UserAPI: GET /api/users
UserAPI -> prisma: user.findMany()
prisma -> User: query users
User --> prisma: user data
prisma --> UserAPI: users array
UserAPI --> UserManagementPage: user list
UserManagementPage --> Admin: Display users

Admin -> UserManagementPage: Update user role
UserManagementPage -> UserAPI: PATCH /api/users
UserAPI -> prisma: user.update()
prisma -> User: update user role
User --> prisma: updated user
prisma --> UserAPI: success
UserAPI --> UserManagementPage: user updated
UserManagementPage --> Admin: User role updated

Admin -> UserManagementPage: Add to whitelist
UserManagementPage -> WhitelistAPI: POST /api/whitelist
WhitelistAPI -> prisma: whitelistedEmail.create()
prisma -> WhitelistedEmail: insert email
WhitelistedEmail --> prisma: email data
prisma --> WhitelistAPI: success
WhitelistAPI --> UserManagementPage: email whitelisted
UserManagementPage --> Admin: Email added to whitelist

@enduml
